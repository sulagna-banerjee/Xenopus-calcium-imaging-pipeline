# Xenopus Calcium Imaging Pipeline

This repository contains a MATLAB-based pipeline for whole-brain and regional calcium imaging analysis in *Xenopus* tadpoles. The workflow supports reproducible ROI detection, manual brain region segmentation, fluorescence extraction, temporal signal analysis, frequency-domain analysis, and group-level comparisons.

The code is designed for **code-only distribution**: users supply their own imaging data and run each step sequentially.

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.17931981.svg)](https://doi.org/10.5281/zenodo.17931981)

---

## Overview of the Pipeline

The pipeline is organised into **whole-brain** and **regional** analysis streams.

### Whole-Brain Analysis
1. **Whole-brain ROI detection**  
   Manual whole-brain masking followed by CalciSeg-based ROI detection.
2. **Fluorescence extraction (whole brain)**  
   Extraction of ROI fluorescence traces and group-wise aggregation.
3. **Peak detection and temporal metrics**  
   High-pass filtering, global thresholding, and detection of significant calcium events.
4. **Frequency-domain analysis (FFT)**  
   Power spectrum estimation and group-level spectral comparisons.

### Regional Analysis
1. **Midbrain and forebrain segmentation**  
   Manual subdivision of the whole brain into midbrain and forebrain regions.
2. **Left–right regional subdivision**  
   Manual separation of midbrain and forebrain into left and right hemispheres.
3. **Central ROI extraction**  
   Generation of fixed-size central circular ROIs within each region.
4. **Inter-regional correlation analysis**  
   Group-level correlation of central ROI fluorescence signals.

---

## Repository Structure



1. `scripts/`
   - `wholebrain/` — whole-brain analysis scripts
   - `regional/` — regional analysis scripts
2. `data/`
   - `control/` — control replicates
   - `test/` — test replicates
3. `results/` — auto-generated outputs


---

## Input Data Requirements

Each replicate directory must contain:
- `final1.tif` — time-series calcium imaging data (TIFF stack)
- Outputs generated by earlier pipeline steps (ROI maps, masks, fluorescence matrices)

### Expected MATLAB Variables
- `fluorescenceData` — ROI × time fluorescence matrix
- `uniqueROIs` — ROI label identifiers matching ROI maps

---

## Software Requirements

- MATLAB (R2024a or later recommended)
- Image Processing Toolbox
- Signal Processing Toolbox
- CalciSeg toolbox (for ROI detection):  
  https://github.com/YannickGuenzel/CalciSeg

---
## Usage

Clone the repository:

`git clone https://github.com/sulagna-banerjee/xenopus-calcium-imaging-pipeline.git`

Place your data into:
- `data/control/`
- `data/test/`

Run scripts sequentially from the `scripts/` directory.

All outputs are written automatically to the `results/` directory.

Scripts are modular and can be run independently once their required inputs are available.

## Citation

If you use this repository, please cite:

**Banerjee, S. (2025).** *Xenopus calcium imaging pipeline (v1.0.0).* Zenodo.  
https://doi.org/10.5281/zenodo.17931981

BibTeX:
```bibtex
@software{banerjee_xenopus_calcium_2025,
  title     = {Xenopus calcium imaging pipeline (v1.0.0)},
  author    = {Banerjee, Sulagna},
  year      = {2025},
  publisher = {Zenodo},
  doi       = {10.5281/zenodo.17931981},
  url       = {https://doi.org/10.5281/zenodo.17931981}
}


