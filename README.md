# Xenopus-calcium-imaging-pipeline
This repository contains a MATLAB-based pipeline for whole-brain and regional calcium imaging analysis in Xenopus tadpoles. The workflow supports reproducible ROI detection, manual brain region segmentation, fluorescence extraction, temporal signal analysis, frequency-domain analysis, and group-level comparisons.

The code is designed for code-only distribution: users supply their own imaging data and run each step sequentially.

Overview of the Pipeline
The pipeline is organised into whole-brain and regional analysis streams:

Whole-Brain Analysis
1) Whole-brain ROI detection - Manual whole-brain masking followed by CalciSeg-based ROI detection.
2) Fluorescence extraction (whole brain) - Extraction of ROI fluorescence traces and group-wise aggregation.
3) Peak detection and temporal metrics - High-pass filtering, global thresholding, and detection of significant calcium events.
4) Frequency-domain analysis (FFT) - Power spectrum estimation and group-level spectral comparisons.

Regional Analysis
1) Midbrain and forebrain segmentation - Manual subdivision of the whole brain into midbrain and forebrain regions.
2) Left–right regional subdivision - Manual separation of midbrain and forebrain into left and right hemispheres.
3) Central ROI extraction - Generation of fixed-size central circular ROIs within each region.
4) Inter-regional correlation analysis - Group-level correlation of central ROI fluorescence signals.

### Repository structure

1. `scripts/`
   - `wholebrain/` — whole-brain analysis scripts
   - `regional/` — regional analysis scripts
2. `data/`
   - `control/` — control replicates
   - `test/` — test replicates
3. `results/` — auto-generated outputs




**Input Data Requirements**
Each replicate directory must contain:
1) final1.tif - Time-series calcium imaging data (TIFF stack).
2) Outputs generated by earlier pipeline steps (ROI maps, masks, fluorescence matrices).

**Expected MATLAB variables:**
1) fluorescenceData — ROI × time fluorescence matrix
2) uniqueROIs — ROI label identifiers matching ROI maps

**Software Requirements**

1) MATLAB (R2024a or later recommended)
2) Image Processing Toolbox
3) Signal Processing Toolbox
4) CalciSeg toolbox (for ROI detection) - https://github.com/YannickGuenzel/CalciSeg

Usage
Clone the repository:
git clone https://github.com/sulagna-banerjee/xenopus-calcium-imaging-pipeline.git


Place your data into the data/control/ and data/test/ directories.

Run scripts sequentially from the scripts/ directory.

All outputs are written automatically to the results/ directory.

Scripts are modular and can be run independently once their required inputs are available.
