# Xenopus-calcium-imaging-pipeline
This repository contains a MATLAB-based pipeline for whole-brain and regional calcium imaging analysis in Xenopus tadpoles. The workflow supports reproducible ROI detection, manual brain region segmentation, fluorescence extraction, temporal signal analysis, frequency-domain analysis, and group-level comparisons.

The code is designed for code-only distribution: users supply their own imaging data and run each step sequentially.

Overview of the Pipeline
The pipeline is organised into whole-brain and regional analysis streams:

Whole-Brain Analysis
1) Whole-brain ROI detection - Manual whole-brain masking followed by CalciSeg-based ROI detection.
2) Fluorescence extraction (whole brain) - Extraction of ROI fluorescence traces and group-wise aggregation.
3) Peak detection and temporal metrics - High-pass filtering, global thresholding, and detection of significant calcium events.
4) Frequency-domain analysis (FFT) - Power spectrum estimation and group-level spectral comparisons.

Regional Analysis
5) Midbrain and forebrain segmentation - Manual subdivision of the whole brain into midbrain and forebrain regions.
6) Left–right regional subdivision - Manual separation of midbrain and forebrain into left and right hemispheres.
7) Central ROI extraction - Generation of fixed-size central circular ROIs within each region.
8) Inter-regional correlation analysis - Group-level correlation of central ROI fluorescence signals.

Repository Structure
xenopus-calcium-imaging-pipeline/
├── scripts/
│   ├── wholebrain/
│   │   ├── step1_wholebrain_roi_detection.m
│   │   ├── step2_wholebrain_fluorescence_extraction.m
│   │   ├── step3_peak_detection.m
│   │   └── step4_fft_analysis.m
│   └── regional/
│       ├── step1_regional_segmentation.m
│       ├── step2_lr_segmentation.m
│       ├── step3_central_roi_extraction.m
│       └── step4_central_roi_correlation.m
├── data/
│   ├── control/
│   │   └── <replicate_id>/
│   └── test/
│       └── <replicate_id>/
├── results/
│   └── (generated automatically)
└── README.md

Input Data Requirements
Each replicate directory must contain:
a) final1.tif - Time-series calcium imaging data (TIFF stack).
b) Outputs generated by earlier pipeline steps (ROI maps, masks, fluorescence matrices).

Expected MATLAB variables:
a) fluorescenceData — ROI × time fluorescence matrix
b) uniqueROIs — ROI label identifiers matching ROI maps

Software Requirements
MATLAB (R2024a or later recommended)
Image Processing Toolbox
Signal Processing Toolbox
CalciSeg toolbox (for ROI detection) - https://github.com/YannickGuenzel/CalciSeg

Usage
Clone the repository:
git clone https://github.com/<username>/xenopus-calcium-imaging-pipeline.git


Place your data into the data/control/ and data/test/ directories.

Run scripts sequentially from the scripts/ directory.

All outputs are written automatically to the results/ directory.

Scripts are modular and can be run independently once their required inputs are available.
